{% extends 'english/flashcards/flashcards_base.html' %}

{% block title %} Revision | FlashCards ({{total}}) {% endblock title %}

{% block body %}
<div class="progress" style="position:relative;top:4;left:1;height:15px;">
    <div class="progress-bar tr-width bg-success" role="progressbar" aria-label="Example with label" style="width:{{progressbarr}}%;" aria-valuenow="{{progressbarr}}" aria-valuemin="0" aria-valuemax="100">{{progressbarr}}%</div>
  </div>
  <div class="progress" style="position:relative;top:10;left:1;height:15px;">
    <div class="progress-bar tr-width" role="progressbar" aria-label="Example with label" style="width:{{progress}}%;" aria-valuenow="{{progress}}" aria-valuemin="0" aria-valuemax="100">{{progress}}%</div>
  </div>
  <div id="flashcard" class="fl_flex_column">
    <div id="inf" onmouseover="show('card_1')" class="{{bg_class}} box-shadow">
      <div class="animate__animated animate__fade"> From: {{inf}} | Cards: {{bar_len}}/{{total}}({{rvtotal}}) | Serial : {{serial}} : {{serial2}} </div>
      <div class="bare">
      <button onclick="show('edit')" class="btn btn-secondary">Edit</button></div>
    </div>
    <div id="card_1" class="p10" style="display:{% if display %}block{% else %}none{% endif%}">{{card_1}}</div>
    <div id="card_2" class="p10 animate__animated animate__slideInUp">{% for x in card_2 %} {{x}} <br/> {% endfor %}</div>
  </div>
  <div class="d-flex justify-content-center align-items-center">
    <div class="m-2"><button onclick="location.reload()" type="button" class="btn btn-danger" style="display:{% if displaybtnrmv %}block{% else %}none{% endif%}">Remove</button></div>
    <div class="m-2"><button onclick="loadDoc()" type="button" class="btn btn-success">Postpone</button></div>
    <div class="m-2"><button onclick="location.href='/revisenext'" type="button" class="btn btn-secondary">Next</button></div>
  </div>

<div class="d-flex justify-content-center align-items-center">
  <div class="m-2"><button onclick="location.href='/flashcards'" type="button" class="btn btn-secondary" accesskey="r">Review</button></div>
  <div class="m-2"><button onclick="location.href='{% url 'revise' %}'" type="button" class="btn btn-success">Revise</button></div>
  <div class="m-2"><button onclick="location.href='{% url 'flmo' %}'" type="button" class="btn btn-secondary">Update FLMO</button></div>
</div>

<div style="position:absolute;top:10px;left:5px;" class="form-check form-switch" title="Definition Font Size">
  <input onclick="card_font();" class="form-check-input" type="checkbox" id="fontt">
</div>
<div style="position:absolute;top:10px;left:55px;" class="form-check form-switch" title="Stop Auto Refresh">
  <input onclick="" class="form-check-input" type="checkbox" id="sar" {{archecked}}>
</div>

  {% comment %} CARD EDIT SCREEN {% endcomment %}
  <div id="edit">
    <div class="edit animate__animated animate__slideInDown">
      <div class="container h-100 d-flex justify-content-center align-items-center">
        <div class="row">
          <div class="col">
            <form action="{% url 'edit' %}" method="post">
              {% csrf_token %}
              <label for="c_1">Card1:</label>
                <textarea class="form-control block_feild" name="c_1" id="c_1">{{card_1}}</textarea>
              <label for="c_2">Card2:</label>
                <textarea class="form-control block_feild" name="c_2" id="c_2">{{card_2_ed}}</textarea>
              <input type="submit" value="submit" class="btn btn-success"/>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% comment %}___________________ {% endcomment %}

  <!--scripts-->
  <script>
    document.addEventListener('keydown', (e) => {
      if (e.key.toLowerCase() === 'f' && e.altKey) {
        e.preventDefault();
        window.location.href = "/flashcards/revisepostponed?pst=8";
      }
      if (e.key.toLowerCase() === 's' && e.altKey) {
        e.preventDefault();
        loadDoc();
      }
    })

    const checkbox = document.getElementById('fontt')
      checkbox.addEventListener('click', (event) => {
      if (event.currentTarget.checked) {
        document.getElementById('card_2').style.fontSize = "40px";
      } else {
        document.getElementById('card_2').style.fontSize = "28px";
      }
    })
    
    const archeck = document.getElementById('sar')
    archeck.addEventListener('click', (event) => {
      if (event.currentTarget.checked) {
        window.location.href = "?archecked=checked";
      } else {
        window.location.href = "?archecked=unchecked";
      }
    })


    function loadDoc() {
      const xhttp = new XMLHttpRequest();
      // xhttp.onload = function() {
      //   document.getElementById("demo").innerHTML =
      //   xhttp.responseText;
      // }
      xhttp.open("GET", "/flashcards/revise{{link}}");
      xhttp.send();
    }
  </script>
  <!--AUTO REFRESHER SCRIPT-->
  <script>
    if (document.getElementById('sar').checked) {
      setTimeout(function() {
        location.reload();
        }, 100000);
      }
  </script>
{% endblock body %}